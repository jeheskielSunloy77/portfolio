---
import '../styles/global.css'
import Footer from '@/components/footer.astro'
import { ChatBot } from '@/components/chat-bot'
import { ClientRouter } from 'astro:transitions'
import Seo from '@/components/seo.astro'
import type { ComponentProps } from 'astro/types'
import ArticleSchema from '@/components/article-schema.astro'
import { type Language } from '@/i18n/i18n'
import { Navbar } from '@/components/navbar'
import type { Dictionary } from '@/lib/types'
import { dictionary } from '@/i18n/dictionary'

export interface Props {
	seo: ComponentProps<typeof Seo>
	articleSchema?: ComponentProps<typeof ArticleSchema>
	lang: Language
}

const { seo, articleSchema, lang } = Astro.props
const t = dictionary[lang]
---

<html lang={lang} class='scroll-smooth'>
	<head>
		<script is:inline data-astro-rerun>
			;(() => {
				const theme = localStorage.getItem('theme')
				const prefersDark = window.matchMedia(
					'(prefers-color-scheme: dark)'
				).matches
				if (theme === 'dark' || (!theme && prefersDark)) {
					document.documentElement.classList.add('dark')
				} else {
					document.documentElement.classList.remove('dark')
				}
			})()
		</script>
		<meta charset='utf-8' />
		<meta name='viewport' content='width=device-width' />
		<Seo {...seo} />
		{articleSchema && <ArticleSchema {...articleSchema} />}
		<ClientRouter />
	</head>
	<body class='font-sans text-foreground bg-background'>
		<Navbar lang={lang} pathname={Astro.url.pathname} t={t} client:load />
		<div class='mx-auto flex max-w-3xl flex-col px-4 sm:px-8 py-24'>
			<main class='grow'>
				<slot />
			</main>
			<ChatBot client:idle t={t} />
		</div>
		<Footer lang={lang} />
	</body>
</html>
